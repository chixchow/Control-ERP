---
phase: 13-glossary-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - skills/control-erp-glossary/control-erp-glossary-SKILL.md
  - skills/control-erp-glossary/gap-log.md
autonomous: true

must_haves:
  truths:
    - "All 36 Crystal Reports are cataloged with name, category, purpose, and coverage status"
    - "Coverage status correctly maps each report to Replaced/Partially covered/Not yet covered against the 6 domain skills"
    - "Gap log exists with uncovered domains and example queries that would trigger them"
    - "Catalog includes guidance text explaining LLM-first approach and when to recommend Crystal Reports"
    - "No incorrect TransactionType values from report_summary.md are cited in the catalog"
  artifacts:
    - path: "skills/control-erp-glossary/control-erp-glossary-SKILL.md"
      provides: "Crystal Reports Catalog section between ORDER LIFECYCLE and NATURAL LANGUAGE ROUTING TABLE"
      contains: "CRYSTAL REPORTS CATALOG"
    - path: "skills/control-erp-glossary/gap-log.md"
      provides: "Uncovered domain tracking with example queries"
      contains: "Uncovered Domains"
  key_links:
    - from: "Crystal Reports Catalog"
      to: "Domain skills (financial, sales, customers, inventory, production)"
      via: "Coverage status references"
      pattern: "Replaced by control-erp-"
---

<objective>
Add a Crystal Reports Catalog section to the glossary skill and create a gap log file.

Purpose: Users asking about reports get accurate guidance on which Crystal Report to run vs. which skill query replaces it. The gap log tracks uncovered domains for future skill development.
Output: Updated glossary with ~100-130 lines of reports catalog; new gap-log.md file
</objective>

<execution_context>
@/Users/cain/.claude/get-shit-done/workflows/execute-plan.md
@/Users/cain/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-glossary-integration/13-CONTEXT.md
@.planning/phases/13-glossary-integration/13-RESEARCH.md
@skills/control-erp-glossary/control-erp-glossary-SKILL.md
@output/report_summary.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Crystal Reports Catalog section to glossary</name>
  <files>skills/control-erp-glossary/control-erp-glossary-SKILL.md</files>
  <action>
Insert a new "## CRYSTAL REPORTS CATALOG" section in the glossary BETWEEN the "ORDER LIFECYCLE AND WORKFLOW TERMINOLOGY" section and the "NATURAL LANGUAGE ROUTING TABLE" section (before the `---` separator that precedes the routing table).

**Structure:**

1. **Header and guidance text (~15 lines):**
   - Explain that Crystal Reports are legacy reporting at FLS, running 15+ years with battle-tested SQL
   - Skills are their modern replacement. "Replaced by" means use the skill query instead
   - LLM answers first. Only recommend running the Crystal Report in Control when:
     (a) the skill doesn't cover that data domain,
     (b) the report has complex formatting that a query can't reproduce (invoices, work orders with proof images),
     (c) the user specifically asks to run a Crystal Report
   - Add disclaimer: "Report details were inferred from filenames and database schema analysis, not extracted from binary .rpt files. Actual report definitions may differ."

2. **Reports table organized by category (~100-110 lines):**
   Use this exact table format per category:

   ```
   ### Financial Reports
   | Report | Purpose | Coverage |
   |--------|---------|----------|
   ```

   Map all 36 reports using the DETAILED MAPPING from 13-RESEARCH.md Section "Coverage Assessment: 36 Crystal Reports vs 6 Domain Skills". The mapping is:

   **Financial Reports (5):**
   - FLS Income Statement.rpt → Replaced by control-erp-financial (Full P&L, P&L Summary)
   - FLS Balance Sheet.rpt → Replaced by control-erp-financial (Balance Sheet Key Accounts)
   - A_R Detail.rpt → Replaced by control-erp-financial (AR Aging Buckets, AR Snapshot)
   - AR Report - Summary.rpt → Replaced by control-erp-financial (AR Aging summary)
   - A_P Aging Detail.rpt → Replaced by control-erp-financial (AP Snapshot, AP Aging)

   **WIP Reports (4):**
   - WIP Summary - Order Level.rpt → Replaced by control-erp-production (Order-Level WIP)
   - WIP By Line Item Station.rpt → Replaced by control-erp-production (LI-Level WIP)
   - WIP By Machine.rpt → Replaced by control-erp-production (WIP by Station)
   - WIP By Calendar Month Due.rpt → Partially covered by control-erp-production

   **Sales Reports (14):**
   - Orders Placed Between.rpt → Replaced by control-erp-sales (Template 1)
   - Sales - By Product.rpt → Replaced by control-erp-sales (Template 3 + 8)
   - Sales - By Product Category.rpt → Partially covered by control-erp-sales
   - Sales - By Customer (Volume).rpt → Replaced by control-erp-customers
   - Sales - By Customer (Frequency).rpt → Replaced by control-erp-customers
   - Sales - By Sales Account.rpt → Partially covered by control-erp-sales
   - Sales - By All Salespeople.rpt → Partially covered by control-erp-sales
   - Sales - By Primary Saleperson.rpt → Replaced by control-erp-sales (Template 7)
   - Based On Sales by Price.rpt → Partially covered by control-erp-sales
   - Based on Orders Placed by Price.rpt → Partially covered by control-erp-sales
   - Sales Graph.rpt → Replaced by control-erp-sales (Template 2)
   - Sales Report.rpt → Replaced by control-erp-sales (Template 1 + 8)
   - Sales - Yearly Sales By Calendar Month.rpt → Replaced by control-erp-sales (Template 9)
   - Sales - Yearly Sales By Salesperson.rpt → Partially covered by control-erp-sales

   **Estimate Reports (4):**
   - Converted Estimates.rpt → Partially covered by control-erp-core
   - Pending Estimates.rpt → Partially covered by control-erp-core
   - Last Order Aging.rpt → Replaced by control-erp-customers (Dormancy)
   - Est. vs Act. Cost Summary By Order.rpt → Not yet covered

   **Inventory & Product Reports (6):**
   - All Parts Listing.rpt → Partially covered by control-erp-inventory
   - Catalog Listing.rpt → Partially covered by control-erp-inventory
   - Inventory Listing.rpt → Partially covered by control-erp-inventory
   - Inventory History.rpt → Partially covered by control-erp-inventory
   - Product Detail.rpt → Not yet covered
   - Product Parameters.rpt → Not yet covered

   **Other Reports (3):**
   - Last Contact Aging.rpt → Partially covered by control-erp-customers
   - Shipped By Date.rpt → Not yet covered
   - Work Order with Proof.rpt → Not yet covered (requires formatted output with embedded images; run in Control)

3. **Coverage summary (~5 lines):**
   ```
   ### Coverage Summary
   | Status | Count | % |
   |--------|-------|---|
   | Replaced by skill | 17 | 47% |
   | Partially covered | 14 | 39% |
   | Not yet covered | 5 | 14% |
   ```

**CRITICAL:** Do NOT cite any TransactionType values from report_summary.md or output/reports/*.md. Those files contain incorrect inferred SQL (e.g., Type 3=Order, StatusID=1600). Only use report NAMES and PURPOSES from those files. The correct coverage mapping is provided above from the research file.

**CRITICAL:** Do NOT include parameter details per CONTEXT.md decision: "Report entries show name and purpose only -- no parameter details."
  </action>
  <verify>
  - Grep for "CRYSTAL REPORTS CATALOG" in the glossary file -- must exist
  - Count report entries: should be exactly 36 rows across all category tables
  - Grep for "TransactionType" within the new catalog section -- should NOT appear (no inferred SQL)
  - Verify section order: ORDER LIFECYCLE → CRYSTAL REPORTS CATALOG → NATURAL LANGUAGE ROUTING TABLE
  - Count total lines: should be between 590-650 lines (491 existing + 100-130 new)
  </verify>
  <done>All 36 Crystal Reports are cataloged with name, purpose, and accurate coverage status. LLM-first guidance text is included. No incorrect TransactionType values cited.</done>
</task>

<task type="auto">
  <name>Task 2: Create gap log file for uncovered domains</name>
  <files>skills/control-erp-glossary/gap-log.md</files>
  <action>
Create a new file `skills/control-erp-glossary/gap-log.md` tracking domains NOT covered by any skill.

**Content structure:**

```markdown
# Control ERP Glossary - Gap Log

**Purpose:** Track every query domain that falls outside current skill coverage. When a user query cannot be answered by any skill, log the domain here. This creates a natural backlog for future skill development.

**Update policy:** Add entries when:
- A user asks a question no skill can answer
- The domain has tables in the database (not a random curiosity)
- The question represents a recurring business need

## Uncovered Domains

| Domain | Example Queries | Tables Exist | Priority | Notes |
|--------|----------------|-------------|----------|-------|
| Payroll / TimeCard | "show me timecards", "who worked overtime", "payroll summary" | Yes (Payroll, PayrollPaycheck, TimeCard) | Medium | Tables fully mapped; FLS does not use per-job time tracking |
| Commissions | "commission rates", "sales commission report", "rep earnings" | Yes (CommissionPlan, CommissionRate) | Low | Tables exist but unknown if FLS uses commissions actively |
| Tax Compliance | "sales tax collected", "tax by state", "tax report" | Yes (TaxClass, TaxLink, PostalCodeTaxClass) | Medium | Tax tables mapped; may be useful for compliance reporting |
| Service Tickets | "open service tickets", "service history" | Yes (ServiceContractType, ServiceTicketPriority) | Low | Only 1 record found in 2025; minimal usage |
| Shipping Detail | "tracking numbers", "shipped today", "shipment history" | Yes (Shipments, FedExShippingLog, UPSShippingLog) | Medium | Tables mapped; shipped-by-date report is not yet covered |
| Product Configuration | "product parameters", "product detail", "how is [product] configured" | Yes (Product, Variable, PricingPlan) | Medium | Product Detail and Product Parameters reports not covered |
| Est vs Actual Cost | "estimated vs actual cost", "cost variance" | Yes (TransDetail cost fields) | Low | Est. vs Act. Cost Summary report not covered |

## Crystal Reports Not Yet Covered

These 5 Crystal Reports have no skill replacement. Run them in Control until a skill is developed:

1. **Est. vs Act. Cost Summary By Order.rpt** -- Compares estimated costs to actual costs per order
2. **Product Detail.rpt** -- Full product configuration and pricing details
3. **Product Parameters.rpt** -- Product parameter/variable definitions
4. **Shipped By Date.rpt** -- Shipment tracking by date range
5. **Work Order with Proof.rpt** -- Formatted work order with embedded proof images (requires rendering, not query-replaceable)

---

*Last updated: [date of plan execution]*
*Domains added: 7 | Reports uncovered: 5*
```
  </action>
  <verify>
  - File exists at skills/control-erp-glossary/gap-log.md
  - Contains "Uncovered Domains" table with at least 5 entries
  - Contains "Crystal Reports Not Yet Covered" section listing all 5 uncovered reports
  - Does NOT contain SQL templates (this is a tracking file, not a skill)
  </verify>
  <done>Gap log exists with 7 uncovered domains and 5 uncovered Crystal Reports, each with example queries and priority levels.</done>
</task>

</tasks>

<verification>
1. `grep -c "CRYSTAL REPORTS CATALOG" skills/control-erp-glossary/control-erp-glossary-SKILL.md` returns 1
2. Count report table rows across all category tables = 36
3. `grep "TransactionType" skills/control-erp-glossary/control-erp-glossary-SKILL.md` does NOT appear in the Crystal Reports Catalog section
4. File skills/control-erp-glossary/gap-log.md exists and contains Uncovered Domains table
5. Glossary file line count is between 590-650 lines
6. Section order verified: ORDER LIFECYCLE before CRYSTAL REPORTS CATALOG before NATURAL LANGUAGE ROUTING TABLE
</verification>

<success_criteria>
- All 36 Crystal Reports documented in glossary with coverage status
- Coverage status accurately maps to existing domain skills
- Gap log file created with uncovered domains
- Glossary stays under 700 lines total
- No incorrect TransactionType values in catalog
</success_criteria>

<output>
After completion, create `.planning/phases/13-glossary-integration/13-01-SUMMARY.md`
</output>
